import pandas as pd
from sqlalchemy import create_engine
from sqlalchemy.exc import SQLAlchemyError

def csv_to_sqlserver():
    try:
        csv_path = r"C:\Users\ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€\Desktop\python\RASS\ProductBonus.csv"

        server = "localhost\\SQLEXPRESS"
        database = "AdventureWorks2022"
        table_name = "my_table"

        df = pd.read_csv(csv_path)
        print("âœ… CSV faylÄ± uÄŸurla oxundu.")

        connection_string = (
            f"mssql+pyodbc://{server}/{database}"
            "?driver=ODBC+Driver+17+for+SQL+Server&trusted_connection=yes"
        )

        engine = create_engine(connection_string)
        print("ğŸ”— SQL Server-É™ baÄŸlantÄ± quruldu.")

        df.to_sql(table_name, con=engine, if_exists="append", index=False)
        print("âœ… CSV mÉ™lumatlarÄ± MSSQL-É™ uÄŸurla É™lavÉ™ olundu!")

    except FileNotFoundError:
        print("âŒ CSV faylÄ± tapÄ±lmadÄ±. ZÉ™hmÉ™t olmasa yolun dÃ¼zgÃ¼nlÃ¼yÃ¼nÃ¼ yoxlayÄ±n.")
    except pd.errors.ParserError:
        print("âŒ CSV faylÄ±nda sintaksis xÉ™tasÄ± var. FaylÄ± yoxlayÄ±n.")
    except SQLAlchemyError as e:
        print(f"âŒ SQL Server baÄŸlantÄ±sÄ± vÉ™ ya yazma zamanÄ± xÉ™ta baÅŸ verdi:\n{e}")
    except Exception as e:
        print(f"âŒ GÃ¶zlÉ™nilmÉ™z xÉ™ta baÅŸ verdi:\n{e}")

csv_to_sqlserver()
